<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<title>Transtopia - 云盘</title>
		<!-- Tell the browser to be responsive to screen width -->
		<meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
	</head>
    
	<body class="customized-scrollbar">
		<!-- 置顶一级导航栏 -->
		<div class="nav-top">
			<div id="firstNavTop"></div>
			<div id="secondNavTop"></div>
		</div>
		
		<!-- 主要展示框 -->
		<div id="mainBlock">
		</div>
		
		<!-- 右下角按钮组 -->
		<div id="btngroup-rightbot">
		</div>
		
	</body>
	
	<!-- 插件与样式 -->
	<!-- jQuery	 -->
	<script src="plugins/jQuery/jquery-2.2.3.min.js"></script>
	
	<!-- jQuery-UI -->
	<script src="plugins/jQueryUI/jquery-ui.min.js"></script>
	
	<!-- Bootstrap 3.3.6 -->
	<link rel="stylesheet" href="plugins/bootstrap-3.3.6/css/bootstrap.min.css" />
	<script src="plugins/bootstrap-3.3.6/js/bootstrap.min.js"></script>
	
	<!-- AdminLTE App -->
	<!-- <link rel="stylesheet" href="plugins/AdminLTE-2.3.11/css/AdminLTE.min.css" />
	<link rel="stylesheet" href="plugins/AdminLTE-2.3.11/css/skins/_all-skins.min.css" />
	<script src="plugins/AdminLTE-2.3.11/js/app.min.js"></script> -->
	
	<!-- Slimscroll -->
	<script src="plugins/slimScroll/jquery.slimscroll.min.js"></script>
	
	<!-- bootstrap-fileinput -->
	<!-- <link href="plugins/bootstrap-fileinput/css/fileinput.css" media="all" rel="stylesheet" type="text/css" />
	<link href="plugins/bootstrap-fileinput/themes/explorer/theme.css" media="all" rel="stylesheet" type="text/css" />
	<script src="plugins/bootstrap-fileinput/js/plugins/sortable.js" type="text/javascript"></script>
	<script src="plugins/bootstrap-fileinput/js/fileinput.js" type="text/javascript"></script>
	<script src="plugins/bootstrap-fileinput/themes/explorer/theme.js" type="text/javascript"></script>
	<script src="plugins/bootstrap-fileinput/js/locales/zh.js" type="text/javascript"></script> -->
	
	<!-- icheck -->
	<link rel="stylesheet" href="plugins/iCheck/all.css">
	<script src="plugins/iCheck/icheck.min.js"></script>
	
	<!-- Select 2 -->
	<link href="plugins/select2/select2.min.css" rel="stylesheet" />
	<link href="plugins/select2/select2-bootstrap.css" rel="stylesheet" />
	<script src="plugins/select2/select2.full.min.js"></script>
	<script src="plugins/select2/i18n/zh-CN.js"></script>
	
	<!-- JQuery Confirm -->
	<link rel="stylesheet" href="plugins/jquery-confirm/jquery-confirm.min.css">
	<script src="plugins/jquery-confirm/jquery-confirm.min.js"></script>
	
	<!-- Google Font -->
	<link href="plugins/material-icons/icon.css" rel="stylesheet">
	
	<!-- Font Awesome -->
	<link rel="stylesheet" href="plugins/font-awesome-4.7.0/css/font-awesome.min.css" />
	
	<!-- bootstrap-wysiwyg -->
	<!-- <link href="plugins/bootstrap-wysiwyg/external/google-code-prettify/prettify.css" rel="stylesheet">
	<script src="plugins/bootstrap-wysiwyg/external/jquery.hotkeys.js"></script>
	<script src="plugins/bootstrap-wysiwyg/external/google-code-prettify/prettify.js"></script>
	<script src="plugins/bootstrap-wysiwyg/bootstrap-wysiwyg.js"></script> -->
	
	
	<!-- <link href="plugins/contextMenu.js-master/contextMenu.min.css" rel="stylesheet">
	<script src="plugins/contextMenu.js-master/contextMenu.js"></script> -->
	
	<!-- jquery download -->
	<!-- <link href="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.2/themes/ui-lightness/jquery-ui.css" rel="stylesheet" type="text/css" /> -->
	<!-- <link href="plugins/jquery-download/Content/Site.css" rel="stylesheet" type="text/css" /> -->
	<!-- <script src="plugins/jquery-download/Scripts/jquery.fileDownload.js" type="text/javascript"></script> -->
	<!-- <script type="text/javascript" src="plugins/jquery-download/Scripts/Support/shCore.js"></script>
	<script type="text/javascript" src="plugins/jquery-download/Scripts/Support/shBrushJScript.js"></script>
	<script type="text/javascript" src="plugins/jquery-download/Scripts/Support/shBrushXml.js"></script>
	<link type="text/css" rel="stylesheet" href="plugins/jquery-download/Content/shCoreDefault.css" />
	<script type="text/javascript" src="plugins/jquery-download/Scripts/Support/jquery.gritter.min.js"></script>
	<link type="text/css" rel="stylesheet" href="plugins/jquery-download/Content/jquery.gritter.css" /> -->
	
	
	<!-- 自定义插件与样式 -->
	<!-- 插件 -->
	<script src="js_gamma/gear.js"></script>
	
	<!-- Static -->
	<script src="js_gamma/static.js"></script>
	
	<!-- Module -->
	<script src="js_gamma/module.js"></script>
	
	<!-- 全局css -->
	<link href="css_gamma/global.css" rel="stylesheet">
	
	<!-- 自定义插件 -->
	<!-- TwinRow -->
	<script src="js_gamma/twinrow.js"></script>
	<link href="css_gamma/twinrow.css" rel="stylesheet">
	<!-- SelectBox -->
	<script src="js_gamma/selectbox.js"></script>
	<link href="css_gamma/selectbox.css" rel="stylesheet">
	
	<!-- 文件 -->
	<script src="js_gamma/filesystem.js"></script>
	<link href="css_gamma/filesystem.css" rel="stylesheet">
	<!-- 测试 -->
	<script src="js_gamma/test_data.js"></script>
	
	<script>
	var FNT = new FirstNavTop();
	FNT.setBrand(dataBrand.name, dataBrand.href);
	FNT.appendCollapseBtn();
	FNT.appendPage('私人');
	FNT.appendNav(dataNav1);
	//FNT.setLeftBtnList(dataNavLink);
	$('#firstNavTop').append(FNT.getModule());
	
	var SNT = new SecondNavTop();
	var dirNav = new DirNav();
	SNT.appendNav(dirNav.getModule());
	SNT.appendNav(dataNav3);
	$('#secondNavTop').append(SNT.getModule());
	
	var LC = new LeftCollapse();
	LC.setBrand(dataBrand.name, dataBrand.href);
	LC.setNav(LEFT_COLLAPSE);
	$('body').append(LC.getModule());
	
	
	
	
	var MB_FS = new MiddleBlock_FS(dirNav);
	dirNav.setBase({id: '1', name: '我的云盘'}, MB_FS.openFolder);
	MB_FS.openFolder(1);
	
	var LB_FS = new LeftBlock_FS(MB_FS, dirNav);
	LB_FS.setNav(navLeft_FS);
	
	/*var folderBlock = new FolderBlock();
	//folderBlock.setTitle('文件夹');
	//folderBlock.setSortBy(SORTBYMENU);
	folderBlock.addList(dataListOfFolder);
	//folderBlock.addList(dataListOfFolder);
	MB_FS.append(folderBlock.getModule());
	
	
	
	
	var folderBlock2 = new FileFolderBlock(new File());
	folderBlock2.setTitle('文件');
	folderBlock2.initSortBy(SORTBYMENU);
	folderBlock2.addList(dataListOfFile);
	MB_FS.append(folderBlock2.getModule());
	
	folderBlock2.getModule().find('[data-type="file"]').click(function(){
		var id = $(this).attr('data-index');
		folderBlock2.remove(id);
		console.log($(this).attr('data-index'));
	});*/
	
	var RB_FS = new RightBlock_FS();

	var MB = new MainBlock();
	LB_FS.getModule().find('.content').css('height', 'calc(100vh - 102px)');
	MB.add(LB_FS.getModule());
	LB_FS.getToggleBtn().find('.content').css('height', 'calc(100vh - 102px)');
	MB.add(LB_FS.getToggleBtn());
	
	MB_FS.getModule().find('.content').css('height', 'calc(100vh - 102px)');
	MB.add(MB_FS.getModule());
	
	RB_FS.getModule().find('.content').css('height', 'calc(100vh - 102px)');
	MB.add(RB_FS.getModule());
	
	
	$('[data-type="left-list"] [data-ation="toggle"]').click(function(){
		RB_FS.toggle();
	});
	
	$('#mainBlock').append(MB.getModule());

	var LinkBox = function(){
		var modal = $(
			'<div class="modal fade">\n' +
			'	<div class="modal-dialog">\n' +
			'		<div class="modal-content">\n' +
			'			<div class="modal-header">\n' +
			'				<button type="button" class="close btn-close" data-dismiss="modal">&times;</button>\n' +
			'				<h4 class="modal-title">' + '分享链接给' + '</h4>\n' +
			'			</div>\n' +
			'			<div class="modal-body">\n' +
			'				<div class="form-group">\n' +
			'					<label><i class="fa fa-link"></i> 链接开关</label>\n' +
			'					<label class="switch pull-right">\n' +
			'						<input name="switch" type="checkbox">\n' +
			'						<div class="slider round"></div>\n' +
			'					</label>\n' +
			'				</div>\n' +
			'				<div class="details" style="display: none;">\n' +
			'					<div class="form-group">\n' +
			'						<label><i class="fa fa-copy"></i> 链接</label>\n' +
			'						<input type="text" class="form-control" value="' + 'http://127.0.0.1:3000/cloud_index' +'" disabled/>\n' +
			'					</div>\n' +
			'					<div class="form-group">\n' +
			'						<label><i class="fa fa-users"></i> 分享链接给</label>\n' +
			'						<select class="form-control shared-with" style="width: 100%;"></select>\n' +
			'					</div>\n' +
			'					<div class="form-group">\n' +
			'						<label><i class="fa fa-eye"></i> 密码</label>\n' +
			'						<label class="switch pull-right">\n' +
			'							<input name="switch-password" type="checkbox">\n' +
			'							<div class="slider round"></div>\n' +
			'						</label>\n' +
			'						<input type="password" name="password" class="form-control" placeholder="请输入密码" style="display: none;"/>\n' +
			'					</div>\n' +
			'				</div>\n' +
			'			</div>\n' +
			'			<div class="modal-footer">\n' +
			'				<a href="javascript: void(0);" data-action="submit">确定</a>\n' +
			'				<a href="javascript: void(0);" data-dismiss="modal">关闭</a>\n' +
			'			</div>\n' +
			'		</div>\n' +
			'	</div>\n' + 
			'</div>'
		);
		
		//初始化
		(function(){
			modal.on('hidden.bs.modal', function(){
				$(this).remove();
			});
			
			modal.find('.shared-with').select2({
				multiple: true,
				placeholder: "请选择您要分享的用户",
				language: 'zh-CN',
				tags: true
			});
			
			modal.find('[name="switch"]').change(function(){
				if($(this).is(':checked')){
					modal.find('.details').show(ANIMATION_TIME);
				}else{
					modal.find('.details').hide(ANIMATION_TIME);
				}
			});
			
			
			modal.find('[name="switch-password"]').change(function(){
				if($(this).is(':checked')){
					modal.find('[name="password"]').show(ANIMATION_TIME);
				}else{
					modal.find('[name="password"]').hide(ANIMATION_TIME);
				}
			});
			
			
			modal.modal('show');
		})();
	};
	
	/* Promise */
	// 获取文件（夹）的可见者列表
	var getVisibilityList = function(fid, type){
		var url;
		if(type == 1){
			// 文件
			url = GET_FILE_VISIBILITY_LIST;
		}else if(type == 2){
			// 文件夹
			url = GET_FOLDER_VISIBILITY_LIST;
		}else{
			console.log('error');
		};
		
		return new Promise(function(resolve, reject){
			$.ajax({
				url : url,
				data: {
					id: fid
				},
				type : "GET",
				dataType : 'json',
				success : function (result){
					// result {value, sublist, tail}
					if(result == 0){
						reject('请求失败1');
					}else{
						resolve(result);
					}
				},
				error: function(err){
					reject('请求失败2');
				}
			});
		});
	};
	
	// 获取文件（夹）的可编辑者列表
	var getEditableList = function(fid, type){
		var url;
		if(type == 1){
			// 文件
			url = GET_FILE_Editable_LIST;
		}else if(type == 2){
			// 文件夹
			url = GET_FOLDER_Editable_LIST;
		}else{
			console.log('error');
		};
		
		return new Promise(function(resolve, reject){
			$.ajax({
				url : url,
				data: {
					id: fid
				},
				type : "GET",
				dataType : 'json',
				success : function (result){
					// result {value, sublist, tail}
					if(result == 0){
						reject('请求失败1');
					}else{
						resolve(result);
					}
				},
				error: function(err){
					reject('请求失败2');
				}
			});
		});
	};
	
	// 获取个人好友标签列表
	var getFriendTags = function(){
		return new Promise(function(resolve, reject){
			$.ajax({
				url : GET_FRIEND_TAG_LIST,
				type : "GET",
				dataType : 'json',
				success : function (result){
					// result {value, sublist, tail}
					if(result == 0){
						reject('请求失败1');
					}else{
						resolve(result);
					}
				},
				error: function(err){
					reject('请求失败2');
				}
			});
		});
	};
	
	// 获取个人好友列表
	var getFriends = function(){
		return new Promise(function(resolve, reject){
			$.ajax({
				url : GET_FRIEND_LIST,
				type : "GET",
				dataType : 'json',
				success : function (result){
					// result {value, sublist, tail}
					if(result === '0'){
						reject('请求失败1');
					}else{
						resolve(result);
					}
				},
				error: function(err){
					reject('请求失败2');
				}
			});
		});
	};
	
	// 获取小组成员列表
	var getGroupMembers = function(groupid){
		return new Promise(function(resolve, reject){
			$.ajax({
				url : GET_GROUP_MEMBER_LIST,
				data: {
					id: groupid
				},
				type : "GET",
				dataType : 'json',
				success : function (result){
					// result {value, sublist, tail}
					if(result === '0'){
						reject('请求失败1');
					}else{
						resolve(result);
					}
				},
				error: function(err){
					reject('请求失败2');
				}
			});
		});
	};
	
	// 获取好友tag中的好友
	var getFriendInTag = function(name){
		return new Promise(function(resolve, reject){
			$.ajax({
				url : GET_FRIEND_IN_TAG,
				data: {
					name: name
				},
				type : "GET",
				dataType : 'json',
				success : function (result){
					// result {value, sublist, tail}
					if(result === '0'){
						reject('请求失败1');
					}else{
						resolve(result);
					}
				},
				error: function(err){
					reject('请求失败2');
				}
			});
		});
	};
	
	//修改文件（夹）观看权限表
	var updateFileFolderVisibility = function(fid, type, tagadd, tagdelete, useradd, userdelete){
		return new Promise(function(resolve, reject){
			$.ajax({
				url : UPDATE_FILE_FOLDER_VISIBILITY,
				data: {
					fid: fid,
					type: type,
					tagadd: tagadd,
					tagdelete: tagdelete,
					useradd: useradd,
					userdelete: userdelete
				},
				type : "GET",
				dataType : 'json',
				success : function (result){
					// result {value, sublist, tail}
					if(result === '0'){
						reject('请求失败1');
					}else{
						resolve(result);
					}
				},
				error: function(err){
					reject('请求失败2');
				}
			});
		});
	};
	
	//修改文件（夹）修改权限表
	var updateFileFolderEditable = function(fid, type, tagadd, tagdelete, useradd, userdelete){
		return new Promise(function(resolve, reject){
			$.ajax({
				url : UPDATE_FILE_FOLDER_Editable,
				data: {
					fid: fid,
					type: type,
					tagadd: tagadd,
					tagdelete: tagdelete,
					useradd: useradd,
					userdelete: userdelete
				},
				type : "GET",
				dataType : 'json',
				success : function (result){
					// result {value, sublist, tail}
					if(result === '0'){
						reject('请求失败1');
					}else{
						resolve(result);
					}
				},
				error: function(err){
					reject('请求失败2');
				}
			});
		});
	};
	

	</script>
</html>


